"use strict";(()=>{var w=(e,t)=>()=>(e&&(t=e(e=0)),t);var j=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var L=(e,t,s)=>new Promise((n,l)=>{var u=r=>{try{g(s.next(r))}catch(a){l(a)}},i=r=>{try{g(s.throw(r))}catch(a){l(a)}},g=r=>r.done?n(r.value):Promise.resolve(r.value).then(u,i);g((s=s.apply(e,t)).next())});var z,P,S=w(()=>{"use strict";z=(e,t)=>{let s=Math.sqrt(t),n=440,l=Math.pow(2,1/12),u=Math.floor((e-1)/s)+1;e=e-u*5-17;let i=Math.floor(e/7+2);return(e+7)%7===0?e=e+i*5:(e+6)%7===0?e=e+i*5+1:(e+5)%7===0||(e+4)%7===0?e=e+i*5+2:(e+3)%7===0?e=e+i*5+3:(e+2)%7===0?e=e+i*5+4:(e+1)%7===0&&(e=e+i*5+5),[+(n*Math.pow(l,e)).toFixed(4),+(n*Math.pow(l,e+3)).toFixed(4)]},P=z});var V,T,q=w(()=>{"use strict";V=(e,t,s)=>{let n=Math.sqrt(e),l=s+n-1,u=s+n,i=s+n+1,g=s-1,r=s+1,a=s-n-1,b=s-n,h=s-n+1;return[l,u,i,g,r,a,b,h].map(v=>t.includes(v)).filter(v=>v!==!1)},T=V});var x,k,H=w(()=>{"use strict";x=class{constructor(t){this.types=["sawtooth","sine","square","triangle"],this.audioContext=new window.AudioContext,this.oscillatorEngine=this.audioContext.createOscillator(),this.oscillatorEngine.type=this.types[Math.floor(Math.random()*4)],this.oscillatorEngine.frequency.setValueAtTime(t,this.audioContext.currentTime),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=.1,this.gainNode.connect(this.audioContext.destination)}},k=x});var J,D,O=w(()=>{"use strict";J=e=>{let t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t},D=J});var K,E,R=w(()=>{"use strict";H();O();K=(e,t,s)=>L(void 0,null,function*(){let n=new k(e),u=yield(()=>L(void 0,null,function*(){let r=n.audioContext.createConvolver(),a=D(t.slice(0));return r.buffer=yield n.audioContext.decodeAudioData(a),r}))();u.connect(n.gainNode),n.oscillatorEngine.connect(u),n.oscillatorEngine.start(),yield new Promise(r=>setTimeout(r,s*.85)).then(()=>{n.oscillatorEngine.stop(),n.oscillatorEngine.disconnect()}),yield new Promise(r=>setTimeout(r,s*1.45)).then(()=>{n.audioContext.close()})}),E=K});var Q=j(G=>{S();q();R();document.addEventListener("DOMContentLoaded",()=>L(G,null,function*(){let e=[...document.querySelectorAll(".pad")],t=[],s=document.querySelector(".grid"),n=e.length,l=document.querySelector(".playButton"),u=document.querySelector(".resetButton"),i=document.querySelector(".modeButton"),g=3,r=2500,a="Mode: Classic",b,h=!1,v=0,M=[],F=window.location.href.includes("file")?"https://cors-anywhere.herokuapp.com/":"",d=yield(yield fetch(`${F}https://jameslewis.io/assets/Output%201-2.wav`)).arrayBuffer(),A=()=>{l.innerHTML=h?"Stop":"Play",s.className=h?"main grid playing":"main grid",i.className=h?"modeButton playing":"modeButton"},B=()=>{h=!1,clearInterval(b),A(),t.forEach(o=>{o.classList.remove("active")}),v=0,M=[],t=[]},U=()=>{if(++v,M.push(t),M.length>2){M.shift();let[o,f]=M.map(c=>c.map(y=>y.id).length>0?c.map(y=>y.id).reduce((y,C)=>y+C):"empty");o===f&&B()}},_=(o,f,c,m)=>{!c&&m===g||c&&(m===g||m===g-1)?(t.includes(o)||t.push(o),c||o.classList.add("active"),o.click()):(t=t.filter(y=>y!==o),c&&o.classList.remove("active"))},$=(o,f,c)=>{Math.floor(Math.random()*10)===0?(t.includes(o)||t.push(o),c||o.classList.add("active"),o.click()):(t=t.filter(m=>m!==o),c&&o.classList.remove("active"))};e.forEach((o,f)=>{let c=n-f,[m,y]=P(c,n);o.id=`${c}`,o.addEventListener("click",()=>{h||(t.includes(o)?(t=t.filter(C=>C!==o),o.classList.remove("active")):(t.push(o),o.classList.add("active"),E(m,d,r))),h&&(Math.floor(v/4)%2===0?E(m,d,r):E(y,d,r))})});let N=()=>{let o=t.map(f=>+f.id);e.forEach((f,c)=>{let m=f.classList.contains("active"),y=T(n,o,+f.id).length;a==="Mode: Classic"&&_(f,c,m,y),a==="Mode: Random"&&$(f,c,m)}),U()};l==null||l.addEventListener("click",()=>{h=!h,A(),h===!0?(N(),b=setInterval(()=>N(),r)):clearInterval(b)}),u==null||u.addEventListener("click",()=>{B()}),i==null||i.addEventListener("click",()=>{a==="Mode: Random"?a="Mode: Classic":a="Mode: Random",i.innerHTML=a})}))});Q();})();
//# sourceMappingURL=brain.js.map
