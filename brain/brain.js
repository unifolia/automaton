"use strict";(()=>{var w=(e,t)=>()=>(e&&(t=e(e=0)),t);var j=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var L=(e,t,r)=>new Promise((o,i)=>{var h=s=>{try{g(r.next(s))}catch(a){i(a)}},y=s=>{try{g(r.throw(s))}catch(a){i(a)}},g=s=>s.done?o(s.value):Promise.resolve(s.value).then(h,y);g((r=r.apply(e,t)).next())});var z,P,S=w(()=>{"use strict";z=e=>{let r=Math.pow(2,.08333333333333333),o=Math.floor((e-1)/8)+1;e=e-o*5-17;let i=Math.floor(e/7+2);return(e+7)%7===0?e=e+i*5:(e+6)%7===0?e=e+i*5+1:(e+5)%7===0||(e+4)%7===0?e=e+i*5+2:(e+3)%7===0?e=e+i*5+3:(e+2)%7===0?e=e+i*5+4:(e+1)%7===0&&(e=e+i*5+5),[+(440*Math.pow(r,e)).toFixed(4),+(440*Math.pow(r,e+3)).toFixed(4)]},P=z});var V,T,k=w(()=>{"use strict";V=(e,t,r)=>{let o=Math.sqrt(e),i=r+o-1,h=r+o,y=r+o+1,g=r-1,s=r+1,a=r-o-1,b=r-o,f=r-o+1;return[i,h,y,g,s,a,b,f].map(v=>t.includes(v)).filter(v=>v!==!1)},T=V});var x,q,H=w(()=>{"use strict";x=class{constructor(t){this.types=["sawtooth","sine","square","triangle"],this.audioContext=new window.AudioContext,this.oscillatorEngine=this.audioContext.createOscillator(),this.oscillatorEngine.type=this.types[Math.floor(Math.random()*4)],this.oscillatorEngine.frequency.setValueAtTime(t,this.audioContext.currentTime),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=.1,this.gainNode.connect(this.audioContext.destination)}},q=x});var J,D,O=w(()=>{"use strict";J=e=>{let t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t},D=J});var K,E,R=w(()=>{"use strict";H();O();K=(e,t,r)=>L(void 0,null,function*(){let o=new q(e),h=yield(()=>L(void 0,null,function*(){let s=o.audioContext.createConvolver(),a=D(t.slice(0));return s.buffer=yield o.audioContext.decodeAudioData(a),s}))();h.connect(o.gainNode),o.oscillatorEngine.connect(h),o.oscillatorEngine.start(),yield new Promise(s=>setTimeout(s,r*.85)).then(()=>{o.oscillatorEngine.stop(),o.oscillatorEngine.disconnect()}),yield new Promise(s=>setTimeout(s,r*1.45)).then(()=>{o.audioContext.close()})}),E=K});var Q=j(G=>{S();k();R();document.addEventListener("DOMContentLoaded",()=>L(G,null,function*(){let e=[...document.querySelectorAll(".pad")],t=[],r=document.querySelector(".grid"),o=e.length,i=document.querySelector(".playButton"),h=document.querySelector(".resetButton"),y=document.querySelector(".modeButton"),g=3,s=2500,a="Mode: Classic",b,f=!1,v=0,M=[],F=window.location.href.includes("file")?"https://cors-anywhere.herokuapp.com/":"",d=yield(yield fetch(`${F}https://jameslewis.io/assets/Output%201-2.wav`)).arrayBuffer(),A=()=>{i.innerHTML=f?"Stop":"Play",r.className=f?"main grid playing":"main grid",y.className=f?"modeButton playing":"modeButton"},B=()=>{f=!1,clearInterval(b),A(),t.forEach(n=>{n.classList.remove("active")}),v=0,M=[],t=[]},U=()=>{if(++v,M.push(t),M.length>2){M.shift();let[n,l]=M.map(c=>c.map(m=>m.id).length>0?c.map(m=>m.id).reduce((m,C)=>m+C):"empty");n===l&&B()}},_=(n,l,c,u)=>{!c&&u===g||c&&(u===g||u===g-1)?(t.includes(n)||t.push(n),c||n.classList.add("active"),n.click()):(t=t.filter(m=>m!==n),c&&n.classList.remove("active"))},$=(n,l,c)=>{Math.floor(Math.random()*10)===0?(t.includes(n)||t.push(n),c||n.classList.add("active"),n.click()):(t=t.filter(u=>u!==n),c&&n.classList.remove("active"))};e.forEach((n,l)=>{let c=o-l,[u,m]=P(c);n.id=`${c}`,n.addEventListener("click",()=>{f||(t.includes(n)?(t=t.filter(C=>C!==n),n.classList.remove("active")):(t.push(n),n.classList.add("active"),E(u,d,s))),f&&(Math.floor(v/4)%2===0?E(u,d,s):E(m,d,s))})});let N=()=>{let n=t.map(l=>+l.id);e.forEach((l,c)=>{let u=l.classList.contains("active"),m=T(o,n,+l.id).length;a==="Mode: Classic"&&_(l,c,u,m),a==="Mode: Random"&&$(l,c,u)}),U()};i==null||i.addEventListener("click",()=>{f=!f,A(),f===!0?(N(),b=setInterval(()=>N(),s)):clearInterval(b)}),h==null||h.addEventListener("click",()=>{B()}),y==null||y.addEventListener("click",()=>{a==="Mode: Random"?a="Mode: Classic":a="Mode: Random",y.innerHTML=a})}))});Q();})();
//# sourceMappingURL=brain.js.map
